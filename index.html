<!DOCTYPE html>
<html>
<script src="processing.js"></script>
<body>
<script  type="text/processing" data-processing-target="mycanvas">
var myPicture;
var yearNumber;
var index = 0;
var array;
var json = [
  [
    {"city":"Beijing","cirle":52},
    {"city":"Hong Kong","cirle":345},
    {"city":"Kaohsiung","cirle":1},
    {"city":"Shanghai","cirle":108},
    {"city":"Shaoguan","cirle":1},
    {"city":"Taipei","cirle":486}
  ],
  [
    {"city":"Beijing","cirle":80},
    {"city":"Hong Kong","cirle":470},
    {"city":"Kaohsiung","cirle":14},
    {"city":"Shanghai","cirle":102},
    {"city":"Taipei","cirle":559},
    {"city":"Xichang","cirle":2}
  ],
  [
    {"city":"Beijing","cirle":163},
    {"city":"Guangzhou","cirle":12},
    {"city":"Hong Kong","cirle":523},
    {"city":"Kaohsiung","cirle":25},
    {"city":"Macau, Macau","cirle":32},
    {"city":"Shanghai","cirle":232},
    {"city":"Shenzhen","cirle":9},
    {"city":"Taipei","cirle":584},
    {"city":"Tianjin","cirle":1}
  ],
  [
    {"city":"Beijing","cirle":188},
    {"city":"Guangzhou","cirle":32},
    {"city":"Hong Kong","cirle":524},
    {"city":"Kaohsiung","cirle":1},
    {"city":"Macau, Macau","cirle":34},
    {"city":"Nanjing","cirle":24},
    {"city":"Shanghai","cirle":414},
    {"city":"Shenyang","cirle":1},
    {"city":"Shenzhen","cirle":40},
    {"city":"Taipei","cirle":543},
    {"city":"Xiamen","cirle":24},
    {"city":"Yinchuan","cirle":1}
  ],
  [
    {"city":"Beijing","cirle":221},
    {"city":"Guangzhou","cirle":31},
    {"city":"Hong Kong","cirle":528},
    {"city":"Nanjing","cirle":19},
    {"city":"Qingdao","cirle":1},
    {"city":"Shanghai","cirle":419},
    {"city":"Shenzhen","cirle":14},
    {"city":"Taipei","cirle":404},
    {"city":"Tianjin","cirle":3},
    {"city":"Yantai","cirle":1}
  ],
  [
    {"city":"Beijing","cirle":140},
    {"city":"Changsha","cirle":3},
    {"city":"Chengdu","cirle":15},
    {"city":"Chongqing","cirle":1},
    {"city":"Guangzhou","cirle":26},
    {"city":"Hangzhou","cirle":2},
    {"city":"Hong Kong","cirle":416},
    {"city":"Nanjing","cirle":6},
    {"city":"Shanghai","cirle":440},
    {"city":"Shenyang","cirle":1},
    {"city":"Shenzhen","cirle":15},
    {"city":"Taipei","cirle":272},
    {"city":"Tianjin","cirle":1},
    {"city":"Wuhan","cirle":6},
    {"city":"Zhengzhou","cirle":22}
  ]
]
;
void preload() {
}

void setup() {
  size(800, 655);
  imageMode(CORNER);
  noStroke();
  background(200);
  myPicture = loadImage("china-blank-map5.jpg");
  yearNumber = 1990;

  array = json[0];
  console.log(array[0].city);
}

void draw() {
  var yearStr = yearNumber.toString();
   image(myPicture,0,0);
  textSize(50);
  fill(100, 102, 153);
  text(yearStr, 380,80);

  textSize(20);

  for (i in array) {
    var city = array[i].city;
    var cirle = array[i].cirle;
    drawEllipse(city,cirle);
  }

}
void mouseClicked(){
  yearNumber += 5;
  index++;
  if (yearNumber == 2020) {
    yearNumber = 1990;
    index = 0;
  }
  array = json[index];
  redraw();
}
void drawEllipse(city,cirle){
var wid = 10;
if (cirle>500) {
  wid = 60;
}else if (cirle>400) {
  wid = 50;
}if (cirle > 200) {
  wid = 40;
}else if (cirle > 100) {
  wid = 30;
}else if (cirle > 20) {
  wid = 20;
}

  switch (city) {
    case "Beijing":
    ellipse(590,255,wid,wid);//Beijing
    text("Beijing", 595,255);
      break;
    case "Hong Kong":
    ellipse(580,560,wid,wid);//Hong Kong
    text("Hong Kong", 595,580);
      break;
    case "Kaohsiung":
    ellipse(682,545,wid,wid);//Kaohsiung
    text("Kaohsiung", 687,545);
        break;
      case "Shanghai":
      ellipse(672,392,wid,wid);//Shanghai
      text("Shanghai", 677,392);
        break;
        case "Shaoguan":
        ellipse(570,540,wid,wid);//Shaoguan
        text("Shaoguan", 575,540);
          break;
        case "Taipei":
        ellipse(695,510,wid,wid);//Taipei
        text("Taipei", 705,510);
          break;
    default:

  }

}



</script>

<canvas id="mycanvas"></canvas>

</body>
</html>
